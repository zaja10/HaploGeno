% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/HaploObject.R
\name{HaploObject}
\alias{HaploObject}
\title{HaploObject Class}
\description{
HaploObject Class

HaploObject Class
}
\section{Public fields}{
\if{html}{\out{<div class="r6-fields">}}
\describe{
\item{\code{geno}}{Filebacked Big Matrix of genotypes.}

\item{\code{map}}{Data.table containing marker map information.}

\item{\code{pheno}}{Vector of phenotypes.}

\item{\code{sample_ids}}{Vector of sample IDs.}

\item{\code{blocks}}{Data.table defining haplotype blocks.}

\item{\code{haplo_mat}}{Matrix of encoded haplotypes.}

\item{\code{hrm}}{Haplotype Relationship Matrix.}

\item{\code{marker_effects}}{Vector of estimated marker effects.}

\item{\code{model_info}}{List containing model training parameters (lambda, p, etc).}

\item{\code{local_gebv}}{List containing local GEBV matrix and variances.}

\item{\code{significance}}{Data.table of significance test results.}

\item{\code{active_markers}}{Integer vector of indices of markers with non-zero variance.}
}
\if{html}{\out{</div>}}
}
\section{Methods}{
\subsection{Public methods}{
\itemize{
\item \href{#method-HaploObject-new}{\code{HaploObject$new()}}
\item \href{#method-HaploObject-print}{\code{HaploObject$print()}}
\item \href{#method-HaploObject-import_genotypes}{\code{HaploObject$import_genotypes()}}
\item \href{#method-HaploObject-load_map}{\code{HaploObject$load_map()}}
\item \href{#method-HaploObject-load_pheno}{\code{HaploObject$load_pheno()}}
\item \href{#method-HaploObject-get_subset}{\code{HaploObject$get_subset()}}
\item \href{#method-HaploObject-define_haploblocks}{\code{HaploObject$define_haploblocks()}}
\item \href{#method-HaploObject-estimate_marker_effects}{\code{HaploObject$estimate_marker_effects()}}
\item \href{#method-HaploObject-encode_haplotypes}{\code{HaploObject$encode_haplotypes()}}
\item \href{#method-HaploObject-calculate_local_gebv}{\code{HaploObject$calculate_local_gebv()}}
\item \href{#method-HaploObject-get_block_markers}{\code{HaploObject$get_block_markers()}}
\item \href{#method-HaploObject-test_significance}{\code{HaploObject$test_significance()}}
\item \href{#method-HaploObject-calculate_pve}{\code{HaploObject$calculate_pve()}}
\item \href{#method-HaploObject-analyze_block_structure}{\code{HaploObject$analyze_block_structure()}}
\item \href{#method-HaploObject-get_model_correlation}{\code{HaploObject$get_model_correlation()}}
\item \href{#method-HaploObject-analyze_structural_drivers}{\code{HaploObject$analyze_structural_drivers()}}
\item \href{#method-HaploObject-compute_hrm}{\code{HaploObject$compute_hrm()}}
\item \href{#method-HaploObject-fit_krr}{\code{HaploObject$fit_krr()}}
\item \href{#method-HaploObject-cross_validate}{\code{HaploObject$cross_validate()}}
\item \href{#method-HaploObject-plot_factor_heatmap}{\code{HaploObject$plot_factor_heatmap()}}
\item \href{#method-HaploObject-plot_block_sizes}{\code{HaploObject$plot_block_sizes()}}
\item \href{#method-HaploObject-plot_hrm}{\code{HaploObject$plot_hrm()}}
\item \href{#method-HaploObject-plot_volcano}{\code{HaploObject$plot_volcano()}}
\item \href{#method-HaploObject-plot_pca}{\code{HaploObject$plot_pca()}}
\item \href{#method-HaploObject-plot_gebv_image}{\code{HaploObject$plot_gebv_image()}}
\item \href{#method-HaploObject-identify_superior_haplotypes}{\code{HaploObject$identify_superior_haplotypes()}}
\item \href{#method-HaploObject-score_stacking}{\code{HaploObject$score_stacking()}}
\item \href{#method-HaploObject-plot_stacking_trend}{\code{HaploObject$plot_stacking_trend()}}
\item \href{#method-HaploObject-impute_genotypes}{\code{HaploObject$impute_genotypes()}}
\item \href{#method-HaploObject-filter_monomorphic}{\code{HaploObject$filter_monomorphic()}}
\item \href{#method-HaploObject-save_project}{\code{HaploObject$save_project()}}
\item \href{#method-HaploObject-scale_haplo_effects}{\code{HaploObject$scale_haplo_effects()}}
\item \href{#method-HaploObject-analyze_hoi}{\code{HaploObject$analyze_hoi()}}
\item \href{#method-HaploObject-plot_haplo_biplot}{\code{HaploObject$plot_haplo_biplot()}}
\item \href{#method-HaploObject-plot_manhattan}{\code{HaploObject$plot_manhattan()}}
\item \href{#method-HaploObject-plot_fa_genome}{\code{HaploObject$plot_fa_genome()}}
\item \href{#method-HaploObject-plot_communality}{\code{HaploObject$plot_communality()}}
\item \href{#method-HaploObject-plot_scree}{\code{HaploObject$plot_scree()}}
\item \href{#method-HaploObject-plot_hoi_distribution}{\code{HaploObject$plot_hoi_distribution()}}
\item \href{#method-HaploObject-get_haplo_extremes}{\code{HaploObject$get_haplo_extremes()}}
\item \href{#method-HaploObject-plot_haplo_profile}{\code{HaploObject$plot_haplo_profile()}}
\item \href{#method-HaploObject-clone}{\code{HaploObject$clone()}}
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-HaploObject-new"></a>}}
\if{latex}{\out{\hypertarget{method-HaploObject-new}{}}}
\subsection{Method \code{new()}}{
Initialize a new HaploObject.
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{HaploObject$new(backing_file_path)}\if{html}{\out{</div>}}
}

\subsection{Arguments}{
\if{html}{\out{<div class="arguments">}}
\describe{
\item{\code{backing_file_path}}{Path to the backing file for the FBM.}
}
\if{html}{\out{</div>}}
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-HaploObject-print"></a>}}
\if{latex}{\out{\hypertarget{method-HaploObject-print}{}}}
\subsection{Method \code{print()}}{
Print a summary of the HaploObject.
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{HaploObject$print()}\if{html}{\out{</div>}}
}

}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-HaploObject-import_genotypes"></a>}}
\if{latex}{\out{\hypertarget{method-HaploObject-import_genotypes}{}}}
\subsection{Method \code{import_genotypes()}}{
Import genotypes from a file or matrix.
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{HaploObject$import_genotypes(matrix_or_path)}\if{html}{\out{</div>}}
}

\subsection{Arguments}{
\if{html}{\out{<div class="arguments">}}
\describe{
\item{\code{matrix_or_path}}{A matrix or path to a file (bed/vcf/rds).}
}
\if{html}{\out{</div>}}
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-HaploObject-load_map"></a>}}
\if{latex}{\out{\hypertarget{method-HaploObject-load_map}{}}}
\subsection{Method \code{load_map()}}{
Load marker map.
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{HaploObject$load_map(map_data)}\if{html}{\out{</div>}}
}

\subsection{Arguments}{
\if{html}{\out{<div class="arguments">}}
\describe{
\item{\code{map_data}}{A data.frame or path to a file.}
}
\if{html}{\out{</div>}}
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-HaploObject-load_pheno"></a>}}
\if{latex}{\out{\hypertarget{method-HaploObject-load_pheno}{}}}
\subsection{Method \code{load_pheno()}}{
Load phenotypes.
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{HaploObject$load_pheno(pheno_data)}\if{html}{\out{</div>}}
}

\subsection{Arguments}{
\if{html}{\out{<div class="arguments">}}
\describe{
\item{\code{pheno_data}}{A vector, data.frame, or path to a file.}
}
\if{html}{\out{</div>}}
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-HaploObject-get_subset"></a>}}
\if{latex}{\out{\hypertarget{method-HaploObject-get_subset}{}}}
\subsection{Method \code{get_subset()}}{
Get a subset of the genotype matrix.
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{HaploObject$get_subset(row_ind, col_ind)}\if{html}{\out{</div>}}
}

\subsection{Arguments}{
\if{html}{\out{<div class="arguments">}}
\describe{
\item{\code{row_ind}}{Row indices.}

\item{\code{col_ind}}{Column indices.}
}
\if{html}{\out{</div>}}
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-HaploObject-define_haploblocks"></a>}}
\if{latex}{\out{\hypertarget{method-HaploObject-define_haploblocks}{}}}
\subsection{Method \code{define_haploblocks()}}{
Define haplotype blocks.
Optimized to run O(N) instead of O(N^2) for LD scanning.
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{HaploObject$define_haploblocks(
  method = "ld",
  r2_threshold = 0.5,
  window_size = 2000,
  tolerance = 2
)}\if{html}{\out{</div>}}
}

\subsection{Arguments}{
\if{html}{\out{<div class="arguments">}}
\describe{
\item{\code{method}}{String. "ld" (default) or "fixed".}

\item{\code{r2_threshold}}{Threshold for LD-based blocking (default 0.5).}

\item{\code{window_size}}{Maximum window size (markers) for LD scan or fixed size.}

\item{\code{tolerance}}{Number of SNPs below r2 threshold allowed before breaking block.}
}
\if{html}{\out{</div>}}
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-HaploObject-estimate_marker_effects"></a>}}
\if{latex}{\out{\hypertarget{method-HaploObject-estimate_marker_effects}{}}}
\subsection{Method \code{estimate_marker_effects()}}{
Estimate marker effects using Ridge Regression.
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{HaploObject$estimate_marker_effects(lambda = "auto")}\if{html}{\out{</div>}}
}

\subsection{Arguments}{
\if{html}{\out{<div class="arguments">}}
\describe{
\item{\code{lambda}}{Regularization parameter. Can be a numeric value or "auto" (default) to estimate optimal lambda via Cross-Validation.}
}
\if{html}{\out{</div>}}
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-HaploObject-encode_haplotypes"></a>}}
\if{latex}{\out{\hypertarget{method-HaploObject-encode_haplotypes}{}}}
\subsection{Method \code{encode_haplotypes()}}{
Encode haplotypes into integer IDs.
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{HaploObject$encode_haplotypes(n_cores = 1)}\if{html}{\out{</div>}}
}

\subsection{Arguments}{
\if{html}{\out{<div class="arguments">}}
\describe{
\item{\code{n_cores}}{Number of cores to use.}
}
\if{html}{\out{</div>}}
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-HaploObject-calculate_local_gebv"></a>}}
\if{latex}{\out{\hypertarget{method-HaploObject-calculate_local_gebv}{}}}
\subsection{Method \code{calculate_local_gebv()}}{
Calculate local GEBVs.
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{HaploObject$calculate_local_gebv(n_cores = 1)}\if{html}{\out{</div>}}
}

\subsection{Arguments}{
\if{html}{\out{<div class="arguments">}}
\describe{
\item{\code{n_cores}}{Number of cores to use.}
}
\if{html}{\out{</div>}}
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-HaploObject-get_block_markers"></a>}}
\if{latex}{\out{\hypertarget{method-HaploObject-get_block_markers}{}}}
\subsection{Method \code{get_block_markers()}}{
Get marker names for a specific block.
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{HaploObject$get_block_markers(block_id)}\if{html}{\out{</div>}}
}

\subsection{Arguments}{
\if{html}{\out{<div class="arguments">}}
\describe{
\item{\code{block_id}}{Integer ID of the block.}
}
\if{html}{\out{</div>}}
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-HaploObject-test_significance"></a>}}
\if{latex}{\out{\hypertarget{method-HaploObject-test_significance}{}}}
\subsection{Method \code{test_significance()}}{
Test significance of local GEBVs.
Uses an Empirical Permutation Test to determine significance thresholds.
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{HaploObject$test_significance()}\if{html}{\out{</div>}}
}

\subsection{Returns}{
Data.table of p-values.
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-HaploObject-calculate_pve"></a>}}
\if{latex}{\out{\hypertarget{method-HaploObject-calculate_pve}{}}}
\subsection{Method \code{calculate_pve()}}{
Calculate Percent Variance Explained (Marginal PVE) by each block.
Computes r^2 between local GEBVs and phenotypes.
Optionally applies "Marker-Out" correction (de-regression) using model parameters.
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{HaploObject$calculate_pve(adjust = TRUE)}\if{html}{\out{</div>}}
}

\subsection{Arguments}{
\if{html}{\out{<div class="arguments">}}
\describe{
\item{\code{adjust}}{Logical. If TRUE, applies correction factor using lambda/p.}
}
\if{html}{\out{</div>}}
}
\subsection{Returns}{
Updated significance table.
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-HaploObject-analyze_block_structure"></a>}}
\if{latex}{\out{\hypertarget{method-HaploObject-analyze_block_structure}{}}}
\subsection{Method \code{analyze_block_structure()}}{
Analyze block structure using internal Factor Analysis (Latent Regression).
Models Local GEBVs as function of latent genomic gradients using Maximum Likelihood Estimation (MLE).
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{HaploObject$analyze_block_structure(
  top_n = 500,
  factors = 2,
  use_covariance = FALSE
)}\if{html}{\out{</div>}}
}

\subsection{Arguments}{
\if{html}{\out{<div class="arguments">}}
\describe{
\item{\code{top_n}}{Number of top variance blocks to use.}

\item{\code{factors}}{Number of latent factors to extract.}

\item{\code{use_covariance}}{Logical. If TRUE, uses the Covariance matrix (preserving magnitude). If FALSE (default), uses Correlation matrix (standardized).}
}
\if{html}{\out{</div>}}
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-HaploObject-get_model_correlation"></a>}}
\if{latex}{\out{\hypertarget{method-HaploObject-get_model_correlation}{}}}
\subsection{Method \code{get_model_correlation()}}{
Reconstruct model-implied correlation matrix from FA results.
G_smooth = Loadings %*% t(Loadings) + diag(SpecificVar)
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{HaploObject$get_model_correlation()}\if{html}{\out{</div>}}
}

\subsection{Returns}{
Implied correlation matrix (N_blocks x N_blocks subset)
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-HaploObject-analyze_structural_drivers"></a>}}
\if{latex}{\out{\hypertarget{method-HaploObject-analyze_structural_drivers}{}}}
\subsection{Method \code{analyze_structural_drivers()}}{
Analyze structural drivers of factor loadings.
Regresses Communality ~ Variance + Position.
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{HaploObject$analyze_structural_drivers()}\if{html}{\out{</div>}}
}

\subsection{Returns}{
A summary of the linear model.
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-HaploObject-compute_hrm"></a>}}
\if{latex}{\out{\hypertarget{method-HaploObject-compute_hrm}{}}}
\subsection{Method \code{compute_hrm()}}{
Compute Haplotype Relationship Matrix.
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{HaploObject$compute_hrm(n_cores = 1)}\if{html}{\out{</div>}}
}

\subsection{Arguments}{
\if{html}{\out{<div class="arguments">}}
\describe{
\item{\code{n_cores}}{Number of cores to use.}
}
\if{html}{\out{</div>}}
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-HaploObject-fit_krr"></a>}}
\if{latex}{\out{\hypertarget{method-HaploObject-fit_krr}{}}}
\subsection{Method \code{fit_krr()}}{
Fit Kernel Ridge Regression model.
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{HaploObject$fit_krr(lambda = 0.1, use_cg = NULL, tol = 1e-05, max_iter = 1000)}\if{html}{\out{</div>}}
}

\subsection{Arguments}{
\if{html}{\out{<div class="arguments">}}
\describe{
\item{\code{lambda}}{Regularization parameter.}

\item{\code{use_cg}}{Whether to use Conjugate Gradient solver.}

\item{\code{tol}}{Tolerance for CG.}

\item{\code{max_iter}}{Maximum iterations for CG.}
}
\if{html}{\out{</div>}}
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-HaploObject-cross_validate"></a>}}
\if{latex}{\out{\hypertarget{method-HaploObject-cross_validate}{}}}
\subsection{Method \code{cross_validate()}}{
Cross-validate KRR model.
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{HaploObject$cross_validate(k = 5, lambdas = NULL, n_cores = 1, folds = NULL)}\if{html}{\out{</div>}}
}

\subsection{Arguments}{
\if{html}{\out{<div class="arguments">}}
\describe{
\item{\code{k}}{Number of folds.}

\item{\code{lambdas}}{Vector of lambdas to test.}

\item{\code{n_cores}}{Number of cores to use.}

\item{\code{folds}}{Optional vector of fold assignments.
Plot the Genetic Correlation Heatmap of Top Blocks.
Reconstructs the correlation matrix from latent factors (G = L L') and visualizes it.}
}
\if{html}{\out{</div>}}
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-HaploObject-plot_factor_heatmap"></a>}}
\if{latex}{\out{\hypertarget{method-HaploObject-plot_factor_heatmap}{}}}
\subsection{Method \code{plot_factor_heatmap()}}{
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{HaploObject$plot_factor_heatmap(
  subset_indices = NULL,
  show_values = FALSE,
  label_axes = TRUE,
  ...
)}\if{html}{\out{</div>}}
}

\subsection{Arguments}{
\if{html}{\out{<div class="arguments">}}
\describe{
\item{\code{subset_indices}}{Vector of block indices (integer) to plot. If NULL, plots all analyzed blocks.}

\item{\code{show_values}}{Logical. If TRUE, overlay the correlation values.}

\item{\code{label_axes}}{Logical. If TRUE, label the axes with block indices.}

\item{\code{...}}{Additional arguments passed to image().}
}
\if{html}{\out{</div>}}
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-HaploObject-plot_block_sizes"></a>}}
\if{latex}{\out{\hypertarget{method-HaploObject-plot_block_sizes}{}}}
\subsection{Method \code{plot_block_sizes()}}{
Plot distribution of Haplotype Block sizes (in number of markers).
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{HaploObject$plot_block_sizes()}\if{html}{\out{</div>}}
}

}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-HaploObject-plot_hrm"></a>}}
\if{latex}{\out{\hypertarget{method-HaploObject-plot_hrm}{}}}
\subsection{Method \code{plot_hrm()}}{
Visualize the Haplotype Relationship Matrix (HRM).
Useful for detecting population structure.
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{HaploObject$plot_hrm()}\if{html}{\out{</div>}}
}

}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-HaploObject-plot_volcano"></a>}}
\if{latex}{\out{\hypertarget{method-HaploObject-plot_volcano}{}}}
\subsection{Method \code{plot_volcano()}}{
Volcano-style plot of Block Variance vs Significance.
Identifies high-variance, highly significant regions.
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{HaploObject$plot_volcano()}\if{html}{\out{</div>}}
}

}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-HaploObject-plot_pca"></a>}}
\if{latex}{\out{\hypertarget{method-HaploObject-plot_pca}{}}}
\subsection{Method \code{plot_pca()}}{
Plot PCA of HRM.
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{HaploObject$plot_pca(groups = NULL)}\if{html}{\out{</div>}}
}

\subsection{Arguments}{
\if{html}{\out{<div class="arguments">}}
\describe{
\item{\code{groups}}{Optional vector of groups for coloring.}
}
\if{html}{\out{</div>}}
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-HaploObject-plot_gebv_image"></a>}}
\if{latex}{\out{\hypertarget{method-HaploObject-plot_gebv_image}{}}}
\subsection{Method \code{plot_gebv_image()}}{
Plot heatmap of local GEBVs.
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{HaploObject$plot_gebv_image(block_range = NULL)}\if{html}{\out{</div>}}
}

\subsection{Arguments}{
\if{html}{\out{<div class="arguments">}}
\describe{
\item{\code{block_range}}{Optional range of blocks to plot.}
}
\if{html}{\out{</div>}}
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-HaploObject-identify_superior_haplotypes"></a>}}
\if{latex}{\out{\hypertarget{method-HaploObject-identify_superior_haplotypes}{}}}
\subsection{Method \code{identify_superior_haplotypes()}}{
Identify superior haplotypes.
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{HaploObject$identify_superior_haplotypes(top_n = 50)}\if{html}{\out{</div>}}
}

\subsection{Arguments}{
\if{html}{\out{<div class="arguments">}}
\describe{
\item{\code{top_n}}{Number of top blocks to consider.}
}
\if{html}{\out{</div>}}
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-HaploObject-score_stacking"></a>}}
\if{latex}{\out{\hypertarget{method-HaploObject-score_stacking}{}}}
\subsection{Method \code{score_stacking()}}{
Calculate stacking scores.
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{HaploObject$score_stacking(superior_haplos)}\if{html}{\out{</div>}}
}

\subsection{Arguments}{
\if{html}{\out{<div class="arguments">}}
\describe{
\item{\code{superior_haplos}}{Data.table of superior haplotypes.}
}
\if{html}{\out{</div>}}
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-HaploObject-plot_stacking_trend"></a>}}
\if{latex}{\out{\hypertarget{method-HaploObject-plot_stacking_trend}{}}}
\subsection{Method \code{plot_stacking_trend()}}{
Plot stacking trend.
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{HaploObject$plot_stacking_trend(scores = NULL, superior_haplos = NULL)}\if{html}{\out{</div>}}
}

\subsection{Arguments}{
\if{html}{\out{<div class="arguments">}}
\describe{
\item{\code{scores}}{Vector of stacking scores.}

\item{\code{superior_haplos}}{Optional table of superior haplotypes (if scores not provided).}
}
\if{html}{\out{</div>}}
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-HaploObject-impute_genotypes"></a>}}
\if{latex}{\out{\hypertarget{method-HaploObject-impute_genotypes}{}}}
\subsection{Method \code{impute_genotypes()}}{
Impute missing genotypes.
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{HaploObject$impute_genotypes(method = "mean")}\if{html}{\out{</div>}}
}

\subsection{Arguments}{
\if{html}{\out{<div class="arguments">}}
\describe{
\item{\code{method}}{Imputation method. "expectation" (default, recommended) replaces NAs with column means without rounding. "mean" rounds to integers but may distort LD.}
}
\if{html}{\out{</div>}}
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-HaploObject-filter_monomorphic"></a>}}
\if{latex}{\out{\hypertarget{method-HaploObject-filter_monomorphic}{}}}
\subsection{Method \code{filter_monomorphic()}}{
Filter monomorphic markers (zero variance).
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{HaploObject$filter_monomorphic()}\if{html}{\out{</div>}}
}

}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-HaploObject-save_project"></a>}}
\if{latex}{\out{\hypertarget{method-HaploObject-save_project}{}}}
\subsection{Method \code{save_project()}}{
Save the project to an RDS file.
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{HaploObject$save_project(path)}\if{html}{\out{</div>}}
}

\subsection{Arguments}{
\if{html}{\out{<div class="arguments">}}
\describe{
\item{\code{path}}{Path to the output .rds file.}
}
\if{html}{\out{</div>}}
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-HaploObject-scale_haplo_effects"></a>}}
\if{latex}{\out{\hypertarget{method-HaploObject-scale_haplo_effects}{}}}
\subsection{Method \code{scale_haplo_effects()}}{
Scale Haplotype Effects.
Centers the local GEBV matrix columns to have a mean of zero.
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{HaploObject$scale_haplo_effects(local_gebv = NULL)}\if{html}{\out{</div>}}
}

\subsection{Arguments}{
\if{html}{\out{<div class="arguments">}}
\describe{
\item{\code{local_gebv}}{A matrix of local GEBVs (N x n_blocks). If NULL, uses self$local_gebv.}
}
\if{html}{\out{</div>}}
}
\subsection{Returns}{
A matrix of scaled local GEBVs.
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-HaploObject-analyze_hoi"></a>}}
\if{latex}{\out{\hypertarget{method-HaploObject-analyze_hoi}{}}}
\subsection{Method \code{analyze_hoi()}}{
Analyze Haplotypes of Interest (HOI).
Identifies superior haplotypes at a specific block by analyzing distribution.
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{HaploObject$analyze_hoi(block_id, local_gebv = NULL)}\if{html}{\out{</div>}}
}

\subsection{Arguments}{
\if{html}{\out{<div class="arguments">}}
\describe{
\item{\code{block_id}}{The ID of the block to analyze.}

\item{\code{local_gebv}}{A matrix of local GEBVs. If NULL, uses self$local_gebv.}
}
\if{html}{\out{</div>}}
}
\subsection{Returns}{
A list containing peak values, p-value, HOI haplotypes, and stats.
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-HaploObject-plot_haplo_biplot"></a>}}
\if{latex}{\out{\hypertarget{method-HaploObject-plot_haplo_biplot}{}}}
\subsection{Method \code{plot_haplo_biplot()}}{
Generate a Genomic Architecture Biplot.
Plots individuals based on HRM PCA and overlays vectors for high-variance haploblocks.
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{HaploObject$plot_haplo_biplot(
  top_n = 10,
  groups = NULL,
  scale_vectors = NULL,
  label_blocks = TRUE,
  highlight_ind = NULL
)}\if{html}{\out{</div>}}
}

\subsection{Arguments}{
\if{html}{\out{<div class="arguments">}}
\describe{
\item{\code{top_n}}{Number of high-variance blocks to display as vectors.}

\item{\code{groups}}{Optional vector of groups for coloring individuals.}

\item{\code{scale_vectors}}{Scalar to adjust the length of vectors for visualization. If NULL, auto-scales.}

\item{\code{label_blocks}}{Boolean, whether to label the block vectors with their IDs.}

\item{\code{highlight_ind}}{Optional. Vector of sample names or indices to highlight.}
}
\if{html}{\out{</div>}}
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-HaploObject-plot_manhattan"></a>}}
\if{latex}{\out{\hypertarget{method-HaploObject-plot_manhattan}{}}}
\subsection{Method \code{plot_manhattan()}}{
Plot Manhattan Plot of Haplotype Blocks (ggplot2 version).
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{HaploObject$plot_manhattan(
  threshold = 0.05,
  main = "Haplotype Block Significance",
  type = "manhattan",
  ...
)}\if{html}{\out{</div>}}
}

\subsection{Arguments}{
\if{html}{\out{<div class="arguments">}}
\describe{
\item{\code{threshold}}{Significance threshold (p-value, default 0.05).}

\item{\code{main}}{Title of the plot.}

\item{\code{type}}{Plot type ("manhattan" or "pve").}

\item{\code{...}}{Additional arguments.}
}
\if{html}{\out{</div>}}
}
\subsection{Returns}{
A ggplot object.
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-HaploObject-plot_fa_genome"></a>}}
\if{latex}{\out{\hypertarget{method-HaploObject-plot_fa_genome}{}}}
\subsection{Method \code{plot_fa_genome()}}{
Plot Factor Analysis Results (Stacked Manhattan Plots).
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{HaploObject$plot_fa_genome(factors = NULL)}\if{html}{\out{</div>}}
}

\subsection{Arguments}{
\if{html}{\out{<div class="arguments">}}
\describe{
\item{\code{factors}}{Vector of factor indices to plot (default: all).}
}
\if{html}{\out{</div>}}
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-HaploObject-plot_communality"></a>}}
\if{latex}{\out{\hypertarget{method-HaploObject-plot_communality}{}}}
\subsection{Method \code{plot_communality()}}{
Plot Communality vs Position.
Visualizes structural drivers (e.g. centromeres).
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{HaploObject$plot_communality()}\if{html}{\out{</div>}}
}

}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-HaploObject-plot_scree"></a>}}
\if{latex}{\out{\hypertarget{method-HaploObject-plot_scree}{}}}
\subsection{Method \code{plot_scree()}}{
Plot Scree Plot of Factor Analysis.
Shows Percent Variance Explained by each factor or singular value.
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{HaploObject$plot_scree()}\if{html}{\out{</div>}}
}

}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-HaploObject-plot_hoi_distribution"></a>}}
\if{latex}{\out{\hypertarget{method-HaploObject-plot_hoi_distribution}{}}}
\subsection{Method \code{plot_hoi_distribution()}}{
Plot HOI Effect Distribution with Checks.
Visualizes the distribution of scaled effects for a block and key check genotypes.
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{HaploObject$plot_hoi_distribution(block_id, highlight_ind = NULL)}\if{html}{\out{</div>}}
}

\subsection{Arguments}{
\if{html}{\out{<div class="arguments">}}
\describe{
\item{\code{block_id}}{Integer. The ID of the block to visualize.}

\item{\code{highlight_ind}}{Optional. Vector of sample names or indices to highlight as checks.}
}
\if{html}{\out{</div>}}
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-HaploObject-get_haplo_extremes"></a>}}
\if{latex}{\out{\hypertarget{method-HaploObject-get_haplo_extremes}{}}}
\subsection{Method \code{get_haplo_extremes()}}{
Identify Extreme Haplotypes.
Returns lists of genotypes carrying the highest and lowest effect haplotypes for top blocks.
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{HaploObject$get_haplo_extremes(top_n = 10, threshold = 1)}\if{html}{\out{</div>}}
}

\subsection{Arguments}{
\if{html}{\out{<div class="arguments">}}
\describe{
\item{\code{top_n}}{Number of blocks to analyze (ranked by variance).}

\item{\code{threshold}}{Standard Deviation threshold for selection (default 1.0).}
}
\if{html}{\out{</div>}}
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-HaploObject-plot_haplo_profile"></a>}}
\if{latex}{\out{\hypertarget{method-HaploObject-plot_haplo_profile}{}}}
\subsection{Method \code{plot_haplo_profile()}}{
Plot Haplotype Profile (Mosaic Heatmap).
Visualizes the "genetic formula" of selected lines across top blocks.
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{HaploObject$plot_haplo_profile(
  genotypes = NULL,
  top_n_blocks = 20,
  sort_by = "pheno"
)}\if{html}{\out{</div>}}
}

\subsection{Arguments}{
\if{html}{\out{<div class="arguments">}}
\describe{
\item{\code{genotypes}}{Optional vector of sample IDs to plot. If NULL, plots all (or top N by phenotype).}

\item{\code{top_n_blocks}}{Number of top variance blocks to visualize.}

\item{\code{sort_by}}{Sorting criteria for genotypes: "pheno" (default), "pc1", "none".}
}
\if{html}{\out{</div>}}
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-HaploObject-clone"></a>}}
\if{latex}{\out{\hypertarget{method-HaploObject-clone}{}}}
\subsection{Method \code{clone()}}{
The objects of this class are cloneable with this method.
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{HaploObject$clone(deep = FALSE)}\if{html}{\out{</div>}}
}

\subsection{Arguments}{
\if{html}{\out{<div class="arguments">}}
\describe{
\item{\code{deep}}{Whether to make a deep clone.}
}
\if{html}{\out{</div>}}
}
}
}
